
夏炘航
gold18075
7.3 AGNES层次聚类
实验总用时：00:00:00
nav
第2关：AGNES算法流程
600
学习内容
参考答案
记录
评论
任务描述
相关知识
AGNES算法流程
编程要求
测试说明
任务描述
本关任务：补充python代码，完成AGNES函数完成聚类功能。

相关知识
为了完成本关任务，你需要掌握AGNES算法流程

AGNES算法流程
AGNES算法是一种自底向上聚合的层次聚类算法，它先会将数据集中的每个样本看作一个初始簇，然后在算法运行的每一步中找出距离最近的两个簇进行合并，直至达到预设的簇的数量。

举个例子，现在先要将西瓜数据聚成两类，数据如下表所示：

编号	体积	重量
1	1.2	2.3
2	3.6	7.1
3	1.1	2.2
4	3.5	6.9
5	1.5	2.5
一开始，每个样本都看成是一个簇(1号样本看成是1号簇，2号样本看成是2号簇，...，5号样本看成是5号簇)，假设簇的集合为C=[[1], [2], [3], [4], [5]]。

假设使用簇间最小距离来度量两个簇之间的远近，从表中可以看出1号簇与3号簇的簇间最小距离最小。因此需要将1号簇和3号簇合并，那么此时簇的集合C=[[1, 3], [2], [4], [5]]。

然后继续看这4个簇中哪两个簇之间的最小距离最小，我们发现2号簇与4号簇的最小距离最小，因此我们要进行合并，合并之后C=[[1, 3], [2, 4], [5]]。

然后继续看这3个簇中哪两个簇之间的最小距离最小，我们发现5号簇与[1, 3]簇的最小距离最小，因此我们要进行合并，合并之后C=[[1, 3, 5], [2, 4]]。

这个时候C中只有两个簇了，达到了我们的预期目标（想要聚成两类），所以算法停止。算法停止后会发现，我们已经将5个西瓜，聚成了两类，一类是小西瓜，另一类是大西瓜。

如果将整个聚类过程中的合并，与合并的次序可视化出来，就能看出为什么说AGNES是自底向上的层次聚类算法了。




AGNES伪代码如下：

#假设数据集为D，想要聚成的簇的数量为k
def AGNES(D, k):
#C为聚类结果
C = []
#将每个样本看成一个簇
for d in D:
C.append(d)
#C中簇的数量
q=len(C)
while q > k:
寻找距离最小的两个簇a和b
将a和b合并，并修改C
q = len(C)
return C
编程要求
在Begin-End区域完成AGNES函数实现聚类功能，并将聚类结果返回(量化距离时请使用簇间最大欧氏距离)。PS:假设数据集为[[1, 2], [10, 11], [1, 3]]，那么聚类结果可能为[[[1, 2], [1, 3]], [[10, 11]]]

其中：

feature：数据集，类型为ndarray
k：表示想要将数据聚成k类，类型为int
测试说明
只需完成AGNES函数即可，程序内部会调用您所完成的AGNES函数对数据进行聚类，若聚类后的簇与真实结果相似度高于0.8视为过关。

开始你的任务吧，祝你成功！

说点什么
1
resize-icon
123456789101112131415
import numpy as np

def AGNES(feature, k):
    '''
    AGNES聚类并返回聚类结果，量化距离时请使用簇间最大欧氏距离
    假设数据集为`[1, 2], [10, 11], [1, 3]]，那么聚类结果可能为`[[1, 2], [1, 3]], [[10, 11]]]
    :param feature:数据集，类型为ndarray
    :param k:表示想要将数据聚成`k`类，类型为`int`
    :return:聚类结果，类型为list

测试结果
测试集1
本关最大执行时间：120秒
上一关
下一关
run
评测
