任务描述
相关知识
为什么需要损失函数
逻辑回归的损失函数
编程要求
测试说明
任务描述
本关任务：根据本节课所学知识完成本关所设置的选择题。

相关知识
为什么需要损失函数
训练逻辑回归模型的过程其实与之前学习的线性回归一样，就是去寻找合适的 W
T
和 b 使得模型的预测结果与真实结果尽可能一致。所以就需要一个函数能够衡量模型拟合程度的好坏，也就是说当模型拟合误差越大的时候，函数值应该比较大，反之应该比较小，这就是损失函数。

逻辑回归的损失函数
根据上一关中所学习到的知识，我们已经知道了逻辑回归计算出的样本所属类别的概率  
p
^
​
=σ(W
T
x+b) ，样本所属列表的判定条件为

y
^
​
={
0
1
​

p
^
​
<0.5
p
^
​
>0.5
​


很明显，在预测样本属于哪个类别时取决于算出来的
p
^
​
。从另外一个角度来说，假设现在有一个样本的真实类别为 1 ，模型预测样本为类别 1 的概率为 0.9 的话，就意味着这个模型认为当前样本的类别有 90% 的可能性为 1 ，有 10% 的可能性为0。所以从这个角度来看，逻辑回归的损失函数与  
p
^
​
有关。

当然逻辑回归的损失函数不仅仅与  
p
^
​
有关，它还与真实类别有关。假设现在有两种情况，情况A：现在有个样本的真实类别是 0 ，但是模型预测出来该样本是类别 1 的概率是 0.7 （也就是说类别 0 的概率为 0.3 ）；情况B：现在有个样本的真实类别是 0 ，但是模型预测出来该样本是类别 1 的概率是 0.6 （也就是说类别 0 的概率为 0.4 ）；请你思考 2 秒钟，AB两种情况哪种情况的误差更大？很显然，情况A的误差更大！因为情况A中模型认为样本是类别 0 的可能性只有 30% ，而B有 40% 。

假设现在又有两种情况，情况A：现在有个样本的真实类别是 0 ，但是模型预测出来该样本是类别 1 的概率是 0.7 （也就是说类别 0 的概率为 0.3 ）；情况B：现在有个样本的真实类别是 1 ，但是模型预测出来该样本是类别 1 的概率是 0.3 （也就是说类别 0 的概率为 0.7 ）；请你再思考 2 秒钟，AB两种情况哪种情况的误差更大？很显然，一样大！

所以逻辑回归的损失函数如下，其中 cost 表示损失函数的值， y 表示样本的真实类别：

cost=−ylog(
p
^
​
)−(1−y)log(1−
p
^
​
)

这个式子其实很好理解，当样本的真实类别为 1 时，式子就变成了 cost=−log(
p
^
​
)。此时函数图像如下：



从图像能看出当样本的真实类别为1的前提下，
p
^
​
越大，损失函数值就越小。因为  
p
^
​
越大就越说明模型越认为该样本的类别为 1 。

当样本的真实类别为 0 时，式子就变成了 cost=−log(1−
p
^
​
) 。此时函数图像如下：



从图像能看出当样本的真实类别为 0 的前提下，hatp 越大，损失函数值就越大。因为  
p
^
​
越大就越说明模型越认为该样本的类别为 1 。

cost=−ylog(
p
^
​
)−(1−y)log(1−
p
^
​
) 是一个样本的损失计算公式，但是在一般情况下需要计算的是 m 条样本数据的平均损失值，所以损失函数的最终形态如下，其中 m 表示数据集中样本的数量， i 表示数据集中第 i 个样本：

cost=−
m
1
​
sum
i=0
m
​
y
(i)
log(
p
^
​

(i)
)−(1−y
(i)
)log(1−
p
^
​

(i)
)

知道了逻辑回归的损失函数之后，逻辑回归的训练流程就很明显了，就是寻找一组合适的 W
T
和 b ，使得损失值最小。找到这组参数后模型就确定下来了。

编程要求
根据相关知识，按照要求完成右侧选择题任务，包含单选题和多选题。

测试说明
平台会对你选择的答案进行判断，全对则通过测试。

开始你的任务吧，祝你成功！