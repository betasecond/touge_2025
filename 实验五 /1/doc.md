
夏炘航
gold13260
5.1 随机森林
实验总用时：00:00:01
nav
第1关：Bagging
300
学习内容
参考答案
记录
评论
任务描述
相关知识
什么是Bagging
Bagging方法如何训练与预测
训练
预测
编程要求
测试说明
任务描述
本关任务：补充 python 代码，完成 BaggingClassifier 类中的 fit 和 predict 函数。请不要修改 Begin-End 段之外的代码。

相关知识
为了完成本关任务，你需要掌握：

什么是 Bagging；
Bagging 算法如何训练与预测。
什么是Bagging
 Bagging 是 Bootstrap Aggregating 的英文缩写，刚接触的童鞋不要误认为 Bagging 是一种算法， Bagging 和 Boosting 都是集成学习中的学习框架，代表着不同的思想。与 Boosting 这种串行集成学习算法不同， Bagging 是并行式集成学习方法。大名鼎鼎的随机森林算法就是在 Bagging 的基础上修改的算法。

Bagging 方法的核心思想就是三个臭皮匠顶个诸葛亮。如果使用 Bagging 解决分类问题，就是将多个分类器的结果整合起来进行投票，选取票数最高的结果作为最终结果。如果使用 Bagging 解决回归问题，就将多个回归器的结果加起来然后求平均，将平均值作为最终结果。

那么 Bagging 方法如此有效呢，举个例子。狼人杀我相信大家都玩过，在天黑之前，村民们都要根据当天所发生的事和别人的发现来投票决定谁可能是狼人。

如果我们将每个村民看成是一个分类器，那么每个村民的任务就是二分类，假设h 
i
​
 (x)表示第 i 个村民认为 x 是不是狼人( -1 代表不是狼人，1 代表是狼人)，f(x)表示 x 真正的身份(是不是狼人)，ϵ表示为村民判断错误的错误率。则有P(h 
i
​
 (x) 

​
 =f(x))=ϵ。

根据狼人杀的规则，村民们需要投票决定天黑前谁是狼人，也就是说如果有超过半数的村民投票时猜对了，那么这一轮就猜对了。那么假设现在有T个村民，H(x)表示投票后最终的结果，则有H(x)=sign(∑ 
i=1
T
​
 h 
i
​
 (x))。

现在假设每个村民都是有主见的人，对于谁是狼人都有自己的想法，那么他们的错误率也是相互独立的。那么根据 Hoeffding不等式 可知，H(x)的错误率为：

P(H(x) 

​
 =f(x))= 
k=0
∑
T/2
​
 C 
T
k
​
 (1−ϵ) 
k
 ϵ 
T−k
 ≤exp(− 
2
1
​
 T(1−2ϵ) 
2
 )

根据上式可知，如果 5 个村民，每个村民的错误率为 0.33，那么投票的错误率为 0.749；如果 20 个村民，每个村民的错误率为 0.33，那么投票的错误率为 0.315；如果 50 个村民，每个村民的错误率为 0.33，那么投票的错误率为 0.056；如果 100 个村民，每个村民的错误率为 0.33，那么投票的错误率为 0.003。从结果可以看出，村民的数量越大，那么投票后犯错的错误率就越小。这也是 Bagging 性能强的原因之一。

Bagging方法如何训练与预测
训练
 Bagging 在训练时的特点就是随机有放回采样和并行。

随机有放回采样：假设训练数据集有 m 条样本数据，每次从这 m 条数据中随机取一条数据放入采样集，然后将其返回，让下一次采样有机会仍然能被采样。然后重复 m 次，就能得到拥有 m 条数据的采样集，该采样集作为 Bagging 的众多分类器中的一个作为训练数据集。假设有 T 个分类器（随便什么分类器），那么就重复 T 此随机有放回采样，构建出 T 个采样集分别作为 T 个分类器的训练数据集。

并行：假设有 10 个分类器，在 Boosting 中，1 号分类器训练完成之后才能开始 2 号分类器的训练，而在 Bagging 中，分类器可以同时进行训练，当所有分类器训练完成之后，整个 Bagging 的训练过程就结束了。

 Bagging 训练过程如下图所示：

 

预测
 Bagging 在预测时非常简单，就是投票！比如现在有 5 个分类器，有 3 个分类器认为当前样本属于 A 类，1 个分类器认为属于 B 类，1 个分类器认为属于 C 类，那么 Bagging 的结果会是 A 类（因为 A 类的票数最高）。

 Bagging 预测过程如下图所示:

 

编程要求
在 begin-end 中完成 BaggingClassifier 类中的 fit 和 predict 函数。分类器可使用 sklearn 提供的 DecisionTreeClassifier。要求模型保存在 self.models 中。

 fit 函数用于 Bagging 的训练过程，其中：

feature ：训练集数据，类型为 ndarray；
label ：训练集标签，类型为 ndarray。
 predict 函数，实现预测功能，并将标签返回，其中：

feature ：测试集数据，类型为 ndarray 。（PS：feature中有多条数据）
测试说明
只需完成 fit 与 predict 函数即可，程序内部会调用您所完成的 fit 函数构建模型并调用 predict 函数来对数据进行预测。预测的准确率高于 0.9 视为过关。

开始你的任务吧，祝你成功！

说点什么
resize-icon
1234567891011121314151617181920212223

import numpy as np
from collections import Counter
from sklearn.tree import DecisionTreeClassifier

class BaggingClassifier():
    def __init__(self, n_model=10):
        '''
        初始化函数
        '''

测试结果
测试集1
本关最大执行时间：120秒
下一关
run
评测
